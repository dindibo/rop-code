#!/usr/bin/python3

from exploiterTemplate import exploiterTemplate
import struct
import os

# TODO: Add inheritance class exploiter
class exploiterRaw(exploiterTemplate):
	def __init__(self) :
		super(exploiterRaw, self).__init__()

	def add_gadet(self, addr : int):
		self.numOfOps += 1
		self.addrs.append(struct.pack('<q', addr))
	
	def finish(self):
		if self.output_file == '':
			raise 'Raw Exploiter must write to file!'

		with open(self.output_file, 'ab+') as f:
			for x in self.addrs:
				f.write(x)
